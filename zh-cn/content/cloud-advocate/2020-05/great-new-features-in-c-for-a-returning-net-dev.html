<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C# 中对重返 .NET 的开发人员来说非常棒的新特性 | Azure 中文精选</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/azureselected/favicon.ico">
    <meta name="description" content="描述了 C# 中3个新特性">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/azureselected/assets/css/0.styles.fe1e9048.css" as="style"><link rel="preload" href="/azureselected/assets/js/app.8a0b7483.js" as="script"><link rel="preload" href="/azureselected/assets/js/2.8d021b4d.js" as="script"><link rel="preload" href="/azureselected/assets/js/54.41189e23.js" as="script"><link rel="preload" href="/azureselected/assets/js/3.32c85e2e.js" as="script"><link rel="preload" href="/azureselected/assets/js/5.554b9b17.js" as="script"><link rel="prefetch" href="/azureselected/assets/js/10.fa73f6fc.js"><link rel="prefetch" href="/azureselected/assets/js/11.e07babbc.js"><link rel="prefetch" href="/azureselected/assets/js/12.12214fd4.js"><link rel="prefetch" href="/azureselected/assets/js/13.b7275e3f.js"><link rel="prefetch" href="/azureselected/assets/js/14.d6b8a728.js"><link rel="prefetch" href="/azureselected/assets/js/15.31a19f47.js"><link rel="prefetch" href="/azureselected/assets/js/16.c3ccb867.js"><link rel="prefetch" href="/azureselected/assets/js/17.7d290d04.js"><link rel="prefetch" href="/azureselected/assets/js/18.4cc5d13c.js"><link rel="prefetch" href="/azureselected/assets/js/19.01296b5f.js"><link rel="prefetch" href="/azureselected/assets/js/20.84db9ad2.js"><link rel="prefetch" href="/azureselected/assets/js/21.6a1d22b6.js"><link rel="prefetch" href="/azureselected/assets/js/22.b38195a7.js"><link rel="prefetch" href="/azureselected/assets/js/23.53dea98b.js"><link rel="prefetch" href="/azureselected/assets/js/24.67816702.js"><link rel="prefetch" href="/azureselected/assets/js/25.8e0307d1.js"><link rel="prefetch" href="/azureselected/assets/js/26.fb128a8f.js"><link rel="prefetch" href="/azureselected/assets/js/27.e8b0b7a9.js"><link rel="prefetch" href="/azureselected/assets/js/28.e625e9de.js"><link rel="prefetch" href="/azureselected/assets/js/29.aeb087ba.js"><link rel="prefetch" href="/azureselected/assets/js/30.8ef68534.js"><link rel="prefetch" href="/azureselected/assets/js/31.6b43ffde.js"><link rel="prefetch" href="/azureselected/assets/js/32.b2f60498.js"><link rel="prefetch" href="/azureselected/assets/js/33.ef0db925.js"><link rel="prefetch" href="/azureselected/assets/js/34.c990c7e7.js"><link rel="prefetch" href="/azureselected/assets/js/35.177548dd.js"><link rel="prefetch" href="/azureselected/assets/js/36.be924c7e.js"><link rel="prefetch" href="/azureselected/assets/js/37.c4a329a3.js"><link rel="prefetch" href="/azureselected/assets/js/38.88502f70.js"><link rel="prefetch" href="/azureselected/assets/js/39.b70a599f.js"><link rel="prefetch" href="/azureselected/assets/js/4.f7cbda98.js"><link rel="prefetch" href="/azureselected/assets/js/40.af1f7c88.js"><link rel="prefetch" href="/azureselected/assets/js/41.09f3637f.js"><link rel="prefetch" href="/azureselected/assets/js/42.91268a34.js"><link rel="prefetch" href="/azureselected/assets/js/43.8bc4e597.js"><link rel="prefetch" href="/azureselected/assets/js/44.e75fe39d.js"><link rel="prefetch" href="/azureselected/assets/js/45.36f7e780.js"><link rel="prefetch" href="/azureselected/assets/js/46.d83d96f0.js"><link rel="prefetch" href="/azureselected/assets/js/47.b54cc2ca.js"><link rel="prefetch" href="/azureselected/assets/js/48.9b7655b1.js"><link rel="prefetch" href="/azureselected/assets/js/49.dc3e7585.js"><link rel="prefetch" href="/azureselected/assets/js/50.44491727.js"><link rel="prefetch" href="/azureselected/assets/js/51.b3cc832a.js"><link rel="prefetch" href="/azureselected/assets/js/52.4b3f7433.js"><link rel="prefetch" href="/azureselected/assets/js/53.d0efb5a8.js"><link rel="prefetch" href="/azureselected/assets/js/55.0604b61d.js"><link rel="prefetch" href="/azureselected/assets/js/56.d1bb56be.js"><link rel="prefetch" href="/azureselected/assets/js/57.2ae826e1.js"><link rel="prefetch" href="/azureselected/assets/js/58.fcca3b58.js"><link rel="prefetch" href="/azureselected/assets/js/59.3da7d882.js"><link rel="prefetch" href="/azureselected/assets/js/6.ef320c88.js"><link rel="prefetch" href="/azureselected/assets/js/60.3f06229c.js"><link rel="prefetch" href="/azureselected/assets/js/61.6e57367f.js"><link rel="prefetch" href="/azureselected/assets/js/62.3b222c6c.js"><link rel="prefetch" href="/azureselected/assets/js/63.8a7f0932.js"><link rel="prefetch" href="/azureselected/assets/js/7.51b986da.js"><link rel="prefetch" href="/azureselected/assets/js/8.a9358b51.js"><link rel="prefetch" href="/azureselected/assets/js/9.b8eed478.js">
    <link rel="stylesheet" href="/azureselected/assets/css/0.styles.fe1e9048.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/azureselected/zh-cn/" class="home-link router-link-active"><img src="/azureselected/img/logo_azure.svg" alt="Azure 中文精选" class="logo"> <span class="site-name can-hide">Azure 中文精选</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/azureselected/zh-cn/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/azureselected/zh-cn/content/" class="nav-link router-link-active">
  内容列表
</a></div><div class="nav-item"><a href="/azureselected/zh-cn/tags.html" class="nav-link">
  标签
</a></div><div class="nav-item"><a href="https://wj.qq.com/s2/5227985/7213/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  参加翻译
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/azureselected/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/azureselected/zh-tw/" class="nav-link">
  繁體中文
</a></li></ul></div></div> <a href="https://github.com/shinyzhu/azureselected" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/azureselected/zh-cn/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/azureselected/zh-cn/content/" class="nav-link router-link-active">
  内容列表
</a></div><div class="nav-item"><a href="/azureselected/zh-cn/tags.html" class="nav-link">
  标签
</a></div><div class="nav-item"><a href="https://wj.qq.com/s2/5227985/7213/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  参加翻译
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/azureselected/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/azureselected/zh-tw/" class="nav-link">
  繁體中文
</a></li></ul></div></div> <a href="https://github.com/shinyzhu/azureselected" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>C# 中对重返 .NET 的开发人员来说非常棒的新特性</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#参考资料" class="sidebar-link">参考资料</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#_1-deconstruction-解构" class="sidebar-link">-1- Deconstruction - 解构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#tuple-元组" class="sidebar-link">Tuple - 元组</a></li><li class="sidebar-sub-header"><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#classes-类" class="sidebar-link">Classes - 类</a></li></ul></li><li><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#_2-pattern-matching-模式匹配" class="sidebar-link">-2- Pattern matching - 模式匹配</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#positional-pattern-位置模式" class="sidebar-link">Positional pattern - 位置模式</a></li><li class="sidebar-sub-header"><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#property-pattern-属性模式" class="sidebar-link">Property pattern - 属性模式</a></li></ul></li><li><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#_3-records-记录" class="sidebar-link">-3- Records - 记录</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/azureselected/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.html#小结" class="sidebar-link">小结</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="c-中对重返-net-的开发人员来说非常棒的新特性"><a href="#c-中对重返-net-的开发人员来说非常棒的新特性" class="header-anchor">#</a> C# 中对重返 .NET 的开发人员来说非常棒的新特性</h1> <div class="content-meta"><hr> <p>原文： <a href="https://softchris.github.io/pages/dotnet-csharp-news.html">https://softchris.github.io/pages/dotnet-csharp-news.html</a></p> <p>作者： Chris Noring | 3/4/2020</p> <!----> <div class="tags-head"><span><a href="/azureselected/zh-cn/tags.html#C#">
      C#
    </a><a href="/azureselected/zh-cn/tags.html#.NET">
      .NET
    </a></span></div> <hr></div> <p>请订阅我的<a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，非常乐意接受您的建议或改进 /Chris</p> <blockquote><p>我离开 .NET 开发已经有一段时间了。实际上我一直在从事全栈 JavaScript 开发，当重新关注 .NET 领域后，我注意到 C# 语言已经添加了一些惊人的功能，以及一些我可以从 JavaScript 和函数式语言中识别出来的特性。这让我非常高兴，因为这意味着 C# 能够从不同的范式及最重要的演化中选择最优秀的部分，变得越来越好。在2000年年初的时候，谁会想到 .NET 现在可以运行在所有平台上？😃</p> <p>那么，这些功能有哪些呢？</p></blockquote> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li><a href="https://docs.microsoft.com/en-us/dotnet/csharp/deconstruct?wt.mc_id=devto-blog-chnoring" target="_blank" rel="noopener noreferrer">解构, 元组和对象<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 该文档涵盖了如何对元组和对象进行解构。它包含了您需要了解的所有内容</li> <li><a href="https://docs.microsoft.com/en-us/archive/msdn-magazine/2019/may/csharp-8-0-pattern-matching-in-csharp-8-0?wt.mc_id=devto-blog-chnoring" target="_blank" rel="noopener noreferrer">C# 8.0 中的模式匹配<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> C# 8.0 附带了对 C# 7.0 中添加的模式匹配的一些更新。</li> <li><a href="https://docs.microsoft.com/en-us/dotnet/csharp/pattern-matching?wt.mc_id=devto-blog-chnoring" target="_blank" rel="noopener noreferrer">模式匹配概述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 该文档涵盖了现有的不同类型的模式匹配。</li> <li><a href="https://blog.cdemi.io/whats-coming-in-c-8-0-records/" target="_blank" rel="noopener noreferrer">Records - 记录初探<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_1-deconstruction-解构"><a href="#_1-deconstruction-解构" class="header-anchor">#</a> -1- Deconstruction - 解构</h2> <p>这是我在 JavaScript 中很喜欢的一个功能，当然在 JavaScript 中它被称为 destructuring。这是什么意思呢？这个想法来自于当你要引用一个对象或一个列表中的项的一些属性，但又不想要全部的属性。让我们来看一个 JavaScript 的例子：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// JavaScript example</span>

<span class="token keyword">function</span> <span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'chris'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">company</span><span class="token operator">:</span> <span class="token string">'Microsoft'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'Cloud Advocate'</span> 
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// without destructuring</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>company<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// with destructuring</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> company <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>company<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你可以看到，当没有使用 destructuring 的时候，即使我只想获取一个成员，也必须键入<code>person</code>。很多多余的字符 😕</p> <blockquote><p>怎样在 C# 中使用呢？</p></blockquote> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> pname<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">var</span></span> pcompany<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">CreatePerson</span><span class="token punctuation">(</span><span class="token string">&quot;chris&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;microsoft&quot;</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>好吧，看起来类似。<code>CreatePerson()</code> 返回的到底是什么呢？</p></blockquote> <p>在这种情况下，它返回一个对象，但也可能是一个元组。</p> <blockquote><p>这样就行了吗？</p></blockquote> <p>这取决于你正在处理什么结构。它目前适用于元组和类，尽管支持类的话你需要做一些额外的工作将它运行起来。</p> <h3 id="tuple-元组"><a href="#tuple-元组" class="header-anchor">#</a> Tuple - 元组</h3> <p>让我们首先通过元组来了解它的来龙去脉。首先创建一个可生成元组的方法。如下所示：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">)</span></span> <span class="token function">GetPerson</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> company<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> company<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们可以通过两种方式进行此操作：</p> <ol><li>从元组访问所有变量</li> <li>仅访问我们所需要的变量但是使用弃元符号 <code>_</code></li></ol> <blockquote><p>译者注：从 C# 7.0 开始，C# 支持弃元，用 <code>_</code> 表示。弃元相当于未赋值的变量，无需为该变量分配存储空间，所以可以减少内存分配。本质上来说这是一种人为取消使用的临时虚拟变量。参考<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/discards" target="_blank" rel="noopener noreferrer">弃元<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>让我们演示第一种情况：</p> <p><strong>所有变量</strong></p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> company<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetPerson</span><span class="token punctuation">(</span><span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// name = &quot;Chris&quot;</span>
<span class="token comment">// company = &quot;Microsoft&quot;</span>
</code></pre></div><p><strong>使用弃元</strong></p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetPerson</span><span class="token punctuation">(</span><span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// name = &quot;Chris&quot;</span>
</code></pre></div><p>在上面的例子中，我们使用 <code>_</code> 表示我们不关心元组中的第二个参数。</p> <blockquote><p>那么如果我们有3个或多个参数，他们是否都被储存在<code>_</code>里？</p></blockquote> <p>并不是。您需要声明每个参数，但我们不关心位置，因此可以像这样输入：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetPerson</span><span class="token punctuation">(</span><span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="classes-类"><a href="#classes-类" class="header-anchor">#</a> Classes - 类</h3> <p>像元组一样，我们可以对类进行解构来访问特定的字段。为了实现这个目的，我们需要将一个 <code>Deconstruct()</code> 方法添加到类中，如下所示：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Company <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Country <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Deconstruct</span><span class="token punctuation">(</span><span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> company<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        name <span class="token operator">=</span> Name<span class="token punctuation">;</span>
        company <span class="token operator">=</span> Company<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Deconstruct</span><span class="token punctuation">(</span><span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> company<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> country<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        name <span class="token operator">=</span> Name<span class="token punctuation">;</span>
        company <span class="token operator">=</span> Company<span class="token punctuation">;</span>
        country <span class="token operator">=</span> Country<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 用如下方式访问</span>
<span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">var</span></span> company<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> Company <span class="token operator">=</span><span class="token string">&quot;Microsoft&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>对于我们不关心的参数，可以使用同样的规则，即使用弃元 <code>_</code>，如下所示：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">var</span></span> company<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> Company <span class="token operator">=</span><span class="token string">&quot;Microsoft&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>上面的例子中，我们丢弃了 <code>country</code>。</p> <p><strong>重载解构方法</strong></p> <p>您可能已经注意到在 <code>Person</code> 类中有两个 <code>Deconstruct()</code> 方法。这是因为我们使用了重载，所以可以有以下两种方式：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">var</span></span> company<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> Company <span class="token operator">=</span><span class="token string">&quot;Microsoft&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>第二个示例：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">var</span></span> company<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> Company <span class="token operator">=</span><span class="token string">&quot;Microsoft&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>在第二个示例中，我们实际上移除了弃元 <code>_</code>，因为我们正在使用带有两个参数的 <code>Deconstruct()</code> 方法。</p> <blockquote><p>但是，我什么时候需要弃元 <code>_</code> 呢？</p></blockquote> <p>在以下的例子中，你仅需要它的一个参数：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> name<span class="token punctuation">,</span> _ <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Chris&quot;</span><span class="token punctuation">,</span> Company <span class="token operator">=</span><span class="token string">&quot;Microsoft&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>这里我们在使用带有两个参数的 <code>Deconstruct()</code> 方法，但是丢弃了最后一个参数。</p> <blockquote><p>那么，我为什么不直接输入 <code>( var name )</code> 呢？</p></blockquote> <p>我只能告诉你它就是这样实现的。只要记住，如果使用重载，需要2个或更多参数来使用它。</p> <p>要了解更多关于解构的内容，请阅读以下文档：</p> <blockquote><p>https://docs.microsoft.com/en-us/dotnet/csharp/deconstruct</p></blockquote> <h2 id="_2-pattern-matching-模式匹配"><a href="#_2-pattern-matching-模式匹配" class="header-anchor">#</a> -2- Pattern matching - 模式匹配</h2> <p>我在像 F# 的函数式语言中见过模式匹配。它的目的是什么？如果你问我的话，我会说这是为了减少输入并在真正要进行比较时更精确。在使用 Switch 的情况下，如何使这些更容易阅读和更有针对性。</p> <blockquote><p>请展示</p></blockquote> <p>好。当我过去使用 C# 时，switch 支持字符串、整数和枚举，仅此而已。当使用对象时 switch 并不合适，我需要使用 if、 else-if 来转换对象。让我们先展示一些代码：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code> <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Character</span> 
    <span class="token punctuation">{</span>
      <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> _name<span class="token punctuation">;</span>
      <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name 
      <span class="token punctuation">{</span> 
        <span class="token keyword">get</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> _name<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">public</span> <span class="token function">Character</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          _name <span class="token operator">=</span> name<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hero</span><span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Character</span></span> 
    <span class="token punctuation">{</span>
      <span class="token keyword">public</span> <span class="token function">Hero</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;The Good&quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Healing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
      <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token string">&quot;Performs healing&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Villain</span><span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Character</span></span> 
    <span class="token punctuation">{</span>
      <span class="token keyword">public</span> <span class="token function">Villain</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;The Evil &quot;</span><span class="token operator">+</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Lightning</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token string">&quot;Performs Force lightning&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>现在假设我们有如下代码：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> hero <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Hero</span><span class="token punctuation">(</span><span class="token string">&quot;Luke&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> villain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Villain</span><span class="token punctuation">(</span><span class="token string">&quot;Darth Vader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Character</span> character <span class="token operator">=</span> hero<span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> ability <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
</code></pre></div><p>现在，让我们加入一些我曾经在 C# 中用过的 switch 逻辑：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">if</span><span class="token punctuation">(</span>character <span class="token keyword">is</span> <span class="token class-name">Hero</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
  <span class="token class-name"><span class="token keyword">var</span></span> h <span class="token operator">=</span> <span class="token punctuation">(</span>Hero<span class="token punctuation">)</span> character<span class="token punctuation">;</span>
  ability <span class="token operator">=</span> h<span class="token punctuation">.</span><span class="token function">Healing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token class-name"><span class="token keyword">var</span></span> v <span class="token operator">=</span> <span class="token punctuation">(</span>Villain<span class="token punctuation">)</span> character<span class="token punctuation">;</span>
  ability <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">Lightning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们对这种用法满意吗？其实并不。好消息是，从 C# 7 起，我们可以这样做：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">switch</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token class-name">Hero</span> hero1<span class="token punctuation">:</span>
        ability <span class="token operator">=</span> hero1<span class="token punctuation">.</span><span class="token function">Healing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token class-name">Villain</span> villain1<span class="token punctuation">:</span>
        ability <span class="token operator">=</span> villain1<span class="token punctuation">.</span><span class="token function">Lightning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在上面的示例中，我们根据条件创建了 <code>hero1</code> 或 <code>villain1</code> 对象。看起来少输入了一些代码。</p> <p>让我们看一下在 C# 8.0 中怎么做：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>ability <span class="token operator">=</span> character <span class="token keyword">switch</span> <span class="token punctuation">{</span>
  <span class="token return-type class-name">Hero</span> hero2 <span class="token operator">=&gt;</span> hero2<span class="token punctuation">.</span><span class="token function">Healing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token return-type class-name">Villain</span> villain2 <span class="token operator">=&gt;</span> villain2<span class="token punctuation">.</span><span class="token function">Lightning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  _ <span class="token operator">=&gt;</span> <span class="token string">&quot;Unknown&quot;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>这看起来真的不错，非常紧凑 😃</p></blockquote> <p>对吧？</p> <h3 id="positional-pattern-位置模式"><a href="#positional-pattern-位置模式" class="header-anchor">#</a> Positional pattern - 位置模式</h3> <p>C# 8 确实令人惊叹，或者至少对于我来说 😃 那么还有其他的吗？我们把它叫做位置模式。这种模式可以让我们检查一个对象，根据它对哪个属性设置的特定的值进行相应的处理。</p> <p>假设我们有一个 Invoice 类。根据它的状态，我们可能要以不同的方式处理它，那么我们如何在给定的模式匹配中表示呢？</p> <p>我们开始之前，先说一下我们将使用 <em>Destruction</em> 做到这一点。那么接下来是你可能感兴趣的东西。假设我们在一个 <code>Invoice</code> 类中有 <code>BossSigned</code> 和 <code>SkipLevelBossSigned</code> 属性。我们制定了一条业务规则，如果老板和更上级的老板已经签署发票，则可以继续处理。</p> <ul><li><code>BossSigned</code>, 值为 <code>null</code> 或签署的日期</li> <li><code>SkipLevelBossSigned</code>, 值为 <code>null</code> 或签署的日期</li></ul> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> invoice <span class="token keyword">switch</span> 
<span class="token punctuation">{</span>
  Invoice <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;Boss need to sign&quot;</span><span class="token punctuation">,</span>
  Invoice <span class="token punctuation">(</span>_ <span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;Skip level boss need to sign&quot;</span><span class="token punctuation">,</span>
  _ <span class="token operator">=&gt;</span> <span class="token string">&quot;All good, process&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="property-pattern-属性模式"><a href="#property-pattern-属性模式" class="header-anchor">#</a> Property pattern - 属性模式</h3> <p>到目前为止，我们为 <code>Invoice</code> 的类型进行了匹配，但我们也可以不用关心类型，只需要匹配属性：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> shape <span class="token keyword">switch</span> 
<span class="token punctuation">{</span>
  <span class="token punctuation">{</span> BossSigned<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">SkipLevelBossSigned</span><span class="token punctuation">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;Boss need to sign&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> SkipLevelBossSigned<span class="token punctuation">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;Skip level boss need to sign&quot;</span><span class="token punctuation">,</span>
  _ <span class="token operator">=&gt;</span> <span class="token string">&quot;All good, process&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的示例其实有个潜在的风险，如果 <code>_</code> 具有 null 值它会匹配到默认的case。在生产环境中使用之前您可能需要修复该问题。</p> <h2 id="_3-records-记录"><a href="#_3-records-记录" class="header-anchor">#</a> -3- Records - 记录</h2> <p>这个特性还没有正式发布，但我感到很兴奋。简而言之，我们可以忘掉字段声明</p> <blockquote><p>你是认真的吗？那要用什么代替呢？看起来会是什么样子？</p></blockquote> <p>这个特性对我来说有点类似 Scala 和 TypeScript，它可以为您完成繁重的工作，即创建字段。在 TypeScript 中看起来像这样：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">class</span> <span class="token class-name">Hero</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> name<span class="token punctuation">:</span> String<span class="token punctuation">,</span> <span class="token keyword">private</span> hp<span class="token punctuation">:</span> number<span class="token punctuation">,</span> <span class="token keyword">public</span> shout<span class="token punctuation">:</span> String<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的示例中为您创建了 <code>name</code>，<code>hp</code> 和 <code>shout</code>。所以无需像这样输入：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// the above would compile to this</span>

<span class="token keyword">class</span> <span class="token class-name">Hero</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token named-parameter punctuation">name</span><span class="token punctuation">:</span> String<span class="token punctuation">,</span> <span class="token named-parameter punctuation">hp</span><span class="token punctuation">:</span> number<span class="token punctuation">,</span> <span class="token named-parameter punctuation">shout</span><span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hp <span class="token operator">=</span> hp<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>shout <span class="token operator">=</span> shout<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>作为 C# 开发人员，这看起来有点倒退，类型放在最后？</p></blockquote> <p>这让我想起了这个说法，但是的，就是这样 😃</p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--_9aQ8vZY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/guwdo0osb696z2arkwc0.jpg" target="_blank" rel="noopener noreferrer"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--_9aQ8vZY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/guwdo0osb696z2arkwc0.jpg" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>如果在 C# 实现将会是什么样？他们正在努力实现它，但提案应该是这样的：</p></blockquote> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hero</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> hp<span class="token punctuation">,</span> <span class="token class-name">String</span> shout<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>以上代码将会被编译成这样：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hero</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IEquatable<span class="token punctuation">&lt;</span>Hero<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> hp<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> shout<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token function">Hero</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> hp<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> shout<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hp <span class="token operator">=</span> hp<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>shout <span class="token operator">=</span> shout<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Equals</span><span class="token punctuation">(</span><span class="token class-name">Hero</span> other<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token comment">//</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Equals</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> other<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token comment">//</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token comment">//</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Deconstruct</span><span class="token punctuation">(</span><span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">int</span></span> hp<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> shout<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      name <span class="token operator">=</span> name<span class="token punctuation">;</span>
      hp <span class="token operator">=</span> hp<span class="token punctuation">;</span>
      shout <span class="token operator">=</span> shout<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">Hero</span> <span class="token function">With</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> age <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> shout <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shout<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Hero</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> shout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>所以，我们会得到很多额外的益处，如 Deconstruct、Equal，并且能使用新的语法 <code>With</code>。 <code>With</code> 也是一个新的东西，可以帮助我们创建新的不可变对象。我们能够像这样输入：</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> hero <span class="token operator">=</span> <span class="token function">GetHero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// get a Hero object from somewhere</span>
<span class="token class-name"><span class="token keyword">var</span></span> newHero <span class="token operator">=</span> hero<span class="token punctuation">.</span><span class="token function">With</span><span class="token punctuation">(</span>hp <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// alt syntax</span>
<span class="token class-name"><span class="token keyword">var</span></span> otherHero <span class="token operator">=</span> hero <span class="token keyword">with</span> <span class="token punctuation">{</span> hp <span class="token operator">=</span> <span class="token number">23</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre></div><h2 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h2> <p>这就是本文的结尾了。如果你像我一样重返 .NET 开发，也许有些感受是相同的或不同的，哦，对了还有 .NET Core，当然，这是个大新闻。能够在 Linux / Mac上运行 .NET，对代码进行容器化等等。谁会想到这一天真的来临？</p> <p>坦白说，我会使用这些结构吗？我肯定会使用模式匹配，即使我在很多时候都采用继承并避免这种逻辑。</p> <p>那么解构呢？对元组来说我会使用，无需额外的工作就可以使用它。那么对象呢？我看到我需要做以下两件事之一：</p> <ol start="2"><li>在一个类上创建一个方法返回所需的元组</li> <li>在有必要的类上添加 <code>Deconstruct()</code> 方法。我会问自己以下问题：我是否需要将字段从类传递到外部环境？字段是否提供了实现细节？属性呢？我们还有包含很多公共字段的DTO对象，因此……</li></ol> <p>记录，我需要它们。迫不及待想看到它们的实现了 😃</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/shinyzhu/azureselected/edit/master/zh-cn/content/cloud-advocate/2020-05/great-new-features-in-c-for-a-returning-net-dev.md" target="_blank" rel="noopener noreferrer">在 GitHub 编辑本页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">最近更新于:</span> <span class="time">6/13/2020, 11:26:48 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/azureselected/assets/js/app.8a0b7483.js" defer></script><script src="/azureselected/assets/js/2.8d021b4d.js" defer></script><script src="/azureselected/assets/js/54.41189e23.js" defer></script><script src="/azureselected/assets/js/3.32c85e2e.js" defer></script><script src="/azureselected/assets/js/5.554b9b17.js" defer></script>
  </body>
</html>
